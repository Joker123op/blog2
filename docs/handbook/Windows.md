## Windows基础命令

Windows仅支持单用户登录

Linux可以支持多用户登录

## DOS控制台基础命令

```
ver //查看系统版本
hostname // 查看主机名
whoami //查看用户名
ipconfig /all //更详细的查看网络配置
net user //查看用户
netstat -ano //查看开放端口
开启的状态： LISTENING、ESTABLISHED
PID-->进程id
tasklist | findstr 8092 //根据pid查看相应的进程
|-->管道符，将前一个命令的标准输出，作为后一个命令的标准输入
```

```
打开注册表：regedit
相当于计算机的数据库，在整个系统中起着核心作用
HKEY_CLASSES_ROOT：管理文件系统
HKEY_CURRENT_USER：仅对当前用户生效
HKEY_LOCAL_MACHINE：对当前主机生效
HKEY_USERS：远程连接的配置
HKEY_CURRENT_CONFIG：保存系统的配置信息
```

```
打开事件查看器：eventvwr.msc
日志存放的位置：C:\Windows\System32\winevt\Logs
4624：登录成功的日志
4625：登录失败的日志
打开系统服务：services.msc
打开组策略编辑器：gpedit.msc
打开本地安全策略：secpol.msc
打开本地用户和组：lusrmgr.msc
```

## TTL

TTL字段：Time To Live的缩写，TTL是生存时间的意思。 大致判断系统类型

修改TTL值

```
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\Tcpip\Parameters
defaultTTL
重启生效
```

死亡ping

```
不断向对方发很大的包
ping -l 65500 192.168.10.128 -t
```

## 创建、删除目录

```
md 目录名 //创建目录
mkdir 目录名 //创建目录
md 1\2\3 //创建多级目录
rd 目录名 //删除空目录
rd /s 目录名 //删除目录树
rd /s /q 目录名 //删除目录树时不询问
```

## 切换目录cd

```
常用cd命令：
➢ cd .. 跳转到上一级目录
➢ cd / 跳转到根目录
➢ cd + path 跳转到path目录
➢ help cd 查看cd命令的详细信息
. //当前目录
.. //上一级目录，可以使用多次
cd ../..
绝对路径：从根目录（盘符）出发
相对路径：从当前目录出发
```

查看目录下的内容：dir

```
命令参数：
➢ /S：递归显示目录下的所有文件
➢ /B：只显示文件和文件夹的名称和
拓展名
➢ /AD：显示当前目录中的子文件夹
➢ /A-D：显示当前目录中的文件
➢ + [路径] ：显示该路径下的文件
```

## 创建、删除文件

```
type nul > 文件名 //创建空文件
type :打印文件内容
echo 123 > 2.txt //创建有内容的文件
> 覆盖
>> 追加
del 文件名 //删除文件
del 目录名 //删除目录下的文件
```

## 复制文件

```
copy 原文件 新文件 //复制并重命名
copy 2.txt+3.txt 4.txt //复制2.txt和3.txt内容到4.txt
```

移动move

```
move 原文件名 新文件名 //移动并改名
```

## 查看端口

```
netstat -ano //查看端口占用情况
netstat –ano | findstr “80” 从所有端口的占用情况中筛选字符80
```

## 查看系统进程

```
tasklist //查看系统的所有进程
taskkill //杀死进程
taskkill /PID XXX /t /f //关闭程序
taskkill /IM 程序名 /t /f //关闭程序
一个程序是由多个进程组成，主进程和子进程，主进程关掉才能彻底关闭程序
```

## 用户管理

```
net user //查看用户
net user 用户名 密码 /add //添加用户
net user 用户名 /del //删除用户
net user 用户名 /active:yes //启用账号
net user 用户名 /active:no //禁用账号
net localgroup administrators //查看管理员组中的成员
net localgroup administrators 用户名 /add //将用户添加到管理员组中
net user 用户名 /time:m-f,13-18 //限制用户可以在周一到周五的13-18登录
net user 用户名 密码 /add /expires:aug,15,2023 //创建用户，并设置用户在2023.8.15过期
```

## 隐藏用户(Windows后门)

```
net user 123$ 123 /add //创建隐藏用户（部分隐藏）
注册表
SAM文件：Windows存放账户和密码的文件
HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users
将users和names里的对应用户配置数据导出
net user 123$ /del //删除隐藏用户（制造假死现象）
将导出的数据重新导入，实现用户完全隐藏
本地安全策略，安全选项，交互式登录，不显示最后用户名 启用
超级隐藏用户：
克隆用户
将普通用户注册表users配置数据里的F值替换成其他用户，实现克隆
超级隐藏用户：
隐藏用户-->克隆管理员的F值
```

## 文件系统和系统目录

文件系统： 

操作系统中负责管理和存储文件信息的软件机构叫做文件管理系统，简称文件系统 

常见的文件系统：

```
NTFS：日志文件系统，windows特有的
FAT16：只支持2GB以下的文件
FAT32：只支持4GB以下的文件
EXFAT：专门为闪存设备设计
```

## 系统载体：“磁盘”介绍

```
每个磁盘不止一个盘片
盘片是有两面的，一面是有效盘面
有效盘面：能装上磁头的盘面
盘面是有编号的，从0开始，从上往下，称为盘面号
```

#### 磁道

```
在格式化时，磁盘会分为很多个同心圆，这个同心圆就称为磁道
一个盘面大概有300-1024个磁道
```

#### 柱面(数据读取)

```
所有盘面上同一磁道构成一个圆柱，这个圆柱就称为柱面
```

#### 扇出(数据存储区)

```
操作系统中以扇区的形式将信息存储
每个扇区包括512字节的数据和其他的数据
一个扇区有两个部分组成：数据存储地点标识符和存储数据的数据段
```

## 簇

```
文件系统存储单元
Windows中存储文件是以簇为存储单位
簇越小越好，越稳定
```

**Linux里的文件系统数据存储单元：块**

## 访问控制

```
cacls test /G admin:F
```

## 系统目录-ProgramData

```
保存了应用程序所需的数据，比如一些自定义的设置，或者缓存文
件，都可能会存放在这里。(隐藏目录)
```

## 系统目录-Program Files

```
X86:表示32位的操作系统
位：表示一次性可以处理多少数据

Program Files-->64位
```

## 系统文件-SAM

```
SAM文件是windows的用户账户数据库,所有用户的登录名及口令等相关信息都会保存在这个文件中。

C:\Windows\System32\config\SAM
```

## 系统文件-hosts

```
windows的本地域名解析文件
域名解析成ip
C:\Windows\System32\drivers\etc\hosts
解析优先级：浏览器的缓存>本地DNS文件>网上的DNS服务器
```

## start值

```
\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\VMAuthdService
```

## 脚本

内容是一段指令集，以一定格式编写的可执行文件 

常见脚本的后缀：.sh、.bat、.py、.jsp、.php....

```
pause:暂停
@echo off:隐藏执行命令，只显示结果

shutdown /s //关机
taskkill /im explorer.exe /t /f //关闭系统资源管理器
```

脚本开机自启

```
注册表：
HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
新建字符串值，名字随意，数值数据（路径)

命令行操作:
reg add HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run /v 注册表
项的名字 /d 脚本路径 /f

/v：添加的值，名字
/d：数值数据
/f：不用提示强行覆盖
```

#### 自解压替换技术：

```
内网的免杀模块
①先准备软件和ico格式的图片
②安装下winrar软件
③右键脚本文件
将脚本文件添加到压缩文件 → √创建自解压格式压缩文件
高级 → 自解压选项 → 解压路径→ 设置 解压后运行 （刚刚路径+文件名）→ 模式 全部隐藏 → 更新 覆盖
所有文件 → 文件和图标
```

## Windows用户和组&域

#### 本地工作组

```
人人平等的模式
同工作组下，同局域网下，通过共享的方式分享文件
加入域后，本地用户登录方式：计算名\用户名
```

#### 域

```
主/从管理模式：域控（皇帝）、域用户（平民百姓）
能实现文件共享，集中统一，便于管理
域用户登陆方式：域名\用户名
```

AD：活动目录，是对账户和资源进行统一管理的机制，域中所有的帐户和共享资源都需要在活动目录中 进行登记，用户可以利用活动目录进行查找和使用这些资源。

DC：域控制器（域控），是一台安装并运行AD的服务器

## 域活动目录逻辑结构

#### 域林 > 域树 > 域 > 组织单元

```
域：管理域内计算机
域树：由2个或以上的域组成
域林：由2个或以上的域树组成
组织单元OU：用于管理、配置策略
```

#### AD域的功能

```
计算机管理
应用系统支撑
桌面配置
管理服务
资源管理
```

## 信任的两种关系形式

```
单向不可传递的信任关系
双向可传递的信任关系
```

## DNS在域控中的作用：定位域控制器

#### 域控环境搭建

```
安装AD域服务
设置静态IP，并将DNS指向域控
添加域内用户，供其他主机登录
```

#### PC配置

```
设置静态IP，将DNS指向域控
将用户加入域
```

#### 桌面策略

```
开始菜单-->管理工具-->组策略管理-->组织单元 右键创建GPO（组策略对象）-->右键组策略对象 编辑
用户配置-->策略-->管理模板-->桌面
图片jpg格式
高级共享（注意权限）
gpupdate //更新组策略
```

## Windows服务端口

一个IP地址的端口有65536（即：2^16）个，端口是通过端口号来标记的，端口号只有整数，范围是从0 到65535（2^16-1）。

#### 常见端口

```
http 80
https 443
telnet 23
ssh 22
ftp 21(命令端口) 20（数据端口）
dhcp 67（服务器） 68（客户端）
rdp 3389
```

#### 通信

```
分为主机间的通信和应用进程间的通信
主机间的通信：两台主机间的应用进程间的通信（网络层）
应用进程间的通信：传输层（协议间的通信）

网络层会为传输层提供服务，应用层会使用传输层的服务
```

#### http--80

```
明文传输
tcp协议、高危端口
```

#### https--443

```
密文传输
https=http+ssl(证书)
```

#### 对称加密

```
算法：des 3des ars
安全性低，效率比非对称加密高
```

#### 非对称加密

```
解决对称加密安全上的问题
只有对应的私钥才能解开对应的公钥，反之亦然
安全性高，功能更强大，速度更慢
```

#### 数据加密

```
若使用公钥对数据进行加密，那么加密的数据只能由对应的私钥进行解密
```

#### 数据签名

```
若使用私钥对数据进行加密，那么加密的数据只能由对应的公钥进行解密
```

## DNS

udp 53

#### DNS污染

```
将DNS服务器里正确的内容改为错的，导致访问错误
```

#### DNS劫持

```
提供错误的DNS服务器
```

## DHCP

```
UDP67和UDP68为默认的DHCP服务端口，分别作为DHCP Server和DHCP Cllent的服务端口，67是用来接收下级客户请求分配IP，68是向服务端发请求成功或失败回应。
```

## telnet 23

```
明文传输，高危端口
```

## RDP 3389

```
修改RDP默认端口
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal
Server\WinStations\RDP-Tcp
PortNumber
重启远程设置
```

