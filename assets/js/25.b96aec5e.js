(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{297:function(t,s,a){"use strict";a.r(s);var e=a(14),r=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"xss注入简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#xss注入简介"}},[t._v("#")]),t._v(" XSS注入简介")]),t._v(" "),s("p",[t._v("XSS简介")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("SQL注入就是将用户输入的数据被当作SQL代码执行")])]),t._v(" "),s("li",[s("p",[t._v("XSS(前端代码注入)")])])]),t._v(" "),s("p",[t._v("前端代码（开源）三块")]),t._v(" "),s("ol",[s("li",[t._v("HTML：网页的框架")]),t._v(" "),s("li",[t._v("CSS：把网站变得更加好看")]),t._v(" "),s("li",[t._v("Javascript：让网页功能更强大")])]),t._v(" "),s("p",[t._v("对于攻击者而言CSS并不重要，因为他只是美化界面，并没有安全效果")]),t._v(" "),s("p",[t._v("攻击的方向是js和如何触发js。因为js很强大，它可以控制浏览器")]),t._v(" "),s("ul",[s("li",[s("code",[t._v('document.cookie="id"')]),t._v("(设置浏览器Cookie的js代码)")]),t._v(" "),s("li",[t._v("偷偷发送数据包(异步传输)")]),t._v(" "),s("li",[t._v("它可以窃取Cookie (先读取你的Cookie然后偷偷发送数据包给黑客，黑客收到Cookie后就可以登录你的账户)")])]),t._v(" "),s("p",[t._v("拿到Cookie不等于拿到密码。（Cookie授权是有时效的）Cookie本身是不安全的，但是为了便捷并且利大于弊的情况下就选择了Cookie")]),t._v(" "),s("p",[t._v("Js的标识：")]),t._v(" "),s("div",{staticClass:"language-JS extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置了一个js弹窗")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("a href"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("javascript"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 伪协议触发")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("img src"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" onerror"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 事件方法（触发器：事件在标签里面on开头的东西很高概率是事件）触发条件是src=1，因为这个本身不成立所以执行了后面的语句")]),t._v("\n")])])]),s("p",[t._v("在实战中不建议使用 "),s("code",[t._v("alert()")]),t._v(" 这个函数进行弹窗，会影响业务正常运行属于风险操作")]),t._v(" "),s("blockquote",[s("p",[t._v("使用以下示例")])]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}},[s("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("123")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("上面三个不仅仅是js的标识还是触发的方法")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://blog.csdn.net/qq_36354324/article/details/106592588",target:"_blank",rel:"noopener noreferrer"}},[t._v("JavaScript事件触发手册"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("有的时候是缓存问题导致无法弹窗CTRL+F5就行了")]),t._v(" "),s("p",[t._v("事件功能非常强大，甚至可以监听键盘鼠标，左键右键，屏幕。")]),t._v(" "),s("p",[t._v("弹出网站cookie")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cookie"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置了一个js弹窗")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("a href"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("javascript"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cookie"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 伪协议触发")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("img src"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" onerror"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cookie"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 事件方法（触发器：事件在标签里面on开头的东西很高概率是事件）触发条件是src=1，因为这个本身不成立所以执行了后面的语句")]),t._v("\n")])])]),s("p",[t._v("XSS分为三种类型：")]),t._v(" "),s("ul",[s("li",[t._v("反射型：你给我传参，然后触发了Js，如果你不给我传参，就不存在(传参里必须包含恶意语句才是标准的反射性XSS语句)")]),t._v(" "),s("li",[t._v("存储型：存储下来的传参，不需要传参中必须有恶意语句。但这样的脚本会被存进数据库，在这之后的所有人在访问这个网站的时候都有可能会执行你写的xss脚本(只要他存储在目标服务器)")])]),t._v(" "),s("p",[t._v("存储型的xss脚本的功能是十分强大的，如果有人在网站的数据库里打入了一个存储型的xss脚本，并且它会获取每个用户的Cookie，那么他就会有盗号等一系列的风险")]),t._v(" "),s("p",[t._v("反射性的xss要点击才会中招")]),t._v(" "),s("p",[s("code",[t._v("http://www.xxx.com/?a=<script>alert(1)<\/script>")]),t._v("这就是一个反射性xss脚本，正常人看见都觉得肯定有问题，所以就可以引入一个东西")]),t._v(" "),s("p",[t._v("叫做短链接，原理很简单，在百度随便一搜就大把多。可以把长链接压缩成短链接，这样就可以引导别人点击。")]),t._v(" "),s("p",[t._v("在实际网站中也会遇见尖括号被编码掉了导致无法注入")]),t._v(" "),s("p",[t._v("前端代码有一个很重要的东西是"),s("strong",[t._v("兼容性")]),t._v("。会对一些东西进行包容")]),t._v(" "),s("p",[t._v("JavaScript还支持一些编码例如：NATIVE")]),t._v(" "),s("p",[t._v("弹窗函数被劫栏会尝试替代"),s("code",[t._v("prompt(1)")])]),t._v(" "),s("p",[s("code",[t._v("payload: 'onfocus=alert(1)autofocus' 当input输入框获取焦点时执行(onfocus)")])]),t._v(" "),s("h2",{attrs:{id:"cookie同源策略"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cookie同源策略"}},[t._v("#")]),t._v(" Cookie同源策略")]),t._v(" "),s("p",[t._v("浏览器的同源策略，限制了不同源的JS，对当前页面的资源和属性的权限。同源策略保护了a.com域名下的资源不被来自其他网页的脚本读取或篡改")]),t._v(" "),s("p",[t._v("所谓同源是：需要同域名/端口、协议")]),t._v(" "),s("p",[t._v("比如\n"),s("code",[t._v("http://www.baidu.com")])]),t._v(" "),s("p",[s("code",[t._v("https://www.baidu.com")])]),t._v(" "),s("p",[t._v("就不是同源的")]),t._v(" "),s("p",[t._v("Js偷Cookie就是读取本地的Cookie发送到我准备好的目标服务器上")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://xssaq.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("XSS平台"),s("OutboundLink")],1),t._v("域名做越短越好")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://joker-1317382260.cos.ap-guangzhou.myqcloud.com/202304181445728.webp",alt:"Img"}})]),t._v(" "),s("p",[t._v("如果只是窃取Cookie勾选这两个就已经够了")]),t._v(" "),s("p",[t._v("给网站添加cookie或者更改的插件是"),s("code",[t._v("EditThisCookie")]),t._v("下载地址放这里了"),s("a",{attrs:{href:"https://github.com/ETCExtensions/Edit-This-Cookie/releases/tag/1.5.0",target:"_blank",rel:"noopener noreferrer"}},[t._v("跳转"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("存储型XSS会出现的地方：")]),t._v(" "),s("ul",[s("li",[t._v("任何可能插入数据库的地方")]),t._v(" "),s("li",[t._v("用户注册的时候")]),t._v(" "),s("li",[t._v("留言板")]),t._v(" "),s("li",[t._v("上传文件的文件名")]),t._v(" "),s("li",[t._v("（管理员可见的）报错信息")])]),t._v(" "),s("p",[t._v("一般情况下来说前台的防御是高于后台的")]),t._v(" "),s("p",[t._v("存储型xss：")]),t._v(" "),s("ol",[s("li",[t._v("同源法则")]),t._v(" "),s("li",[t._v("XSS平台")]),t._v(" "),s("li",[t._v("存储型XSS并不是非得存数据库")]),t._v(" "),s("li",[t._v("XSS可以见框就插")])]),t._v(" "),s("h2",{attrs:{id:"dom-based-xss"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dom-based-xss"}},[t._v("#")]),t._v(" Dom Based XSS")]),t._v(" "),s("p",[t._v("Dom是一个Js可以操控浏览器和网页的接口")]),t._v(" "),s("p",[t._v("Dom不会经过服务器，本质上是自己打自己，因为每次有用户访问网站都会需要服务器对他分配一定资源，如果是有100万人同时访问，甚至更多。就会导致服务器压力过大。")]),t._v(" "),s("p",[t._v("所以这个时候就需要经过用户自己的本地，可以一定程度上给服务器减轻一部分压力，所以产生了漏洞")]),t._v(" "),s("p",[t._v("每个载入浏览器的HTML文档都会成为Document对象。")]),t._v(" "),s("p",[t._v("Document对象使我们可以从脚本中对HTML页面中的所有元素进行访问。")]),t._v(" "),s("p",[t._v("Document的对象属性")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("属性")]),t._v(" "),s("th",[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("body")]),t._v(" "),s("td",[t._v("提供对"),s("code",[t._v("<body>")]),t._v("元素的直接访问。对于定义了框架集的文档，该属性引用最外层的"),s("code",[t._v("<frameset>")])])]),t._v(" "),s("tr",[s("td",[t._v("cookie")]),t._v(" "),s("td",[t._v("设置或返回与当前文档有关的所有cookie")])]),t._v(" "),s("tr",[s("td",[t._v("domain")]),t._v(" "),s("td",[t._v("返回当前文档的域名")])]),t._v(" "),s("tr",[s("td",[t._v("lastModified")]),t._v(" "),s("td",[t._v("返回文档被修改的最后日期和时间。")])]),t._v(" "),s("tr",[s("td",[t._v("referrer")]),t._v(" "),s("td",[t._v("返回载入当前文档的文档url。")])]),t._v(" "),s("tr",[s("td",[t._v("title")]),t._v(" "),s("td",[t._v("返回当前文档的标题。")])]),t._v(" "),s("tr",[s("td",[t._v("URL")]),t._v(" "),s("td",[t._v("返回当前文档的URL，")])])])]),t._v(" "),s("p",[t._v("这是上述函数的使用方法")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("函数")]),t._v(" "),s("th",[t._v("作用")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("document.body")]),t._v(" "),s("td",[t._v("提取Body信息")])]),t._v(" "),s("tr",[s("td",[t._v("document.domain")]),t._v(" "),s("td",[t._v("提取当前页面域名")])]),t._v(" "),s("tr",[s("td",[t._v("document.lastModified")]),t._v(" "),s("td",[t._v("查看当前页面的最后修改时间（同时也可以查看网站是否是静态网站）")])])])]),t._v(" "),s("p",[t._v("详细内容可以看看这篇扩展文章"),s("a",{attrs:{href:"https://blog.csdn.net/weixin_45634365/article/details/114536958",target:"_blank",rel:"noopener noreferrer"}},[t._v("Dom Based XSS"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("在真是网络环境中，还会存在一些伪静态网页，他们本质上还是动态。一样可以进行SQL注入。判断方法是使用函数"),s("code",[t._v("document.lastModified")]),t._v("来查看")]),t._v(" "),s("p",[t._v("要依靠当前页面JS才能触发的漏洞，可以理解为dom型xss")])])}),[],!1,null,null,null);s.default=r.exports}}]);